# å…¨è‡ªåŠ¨947é¬¼å›¾

è¿™æ˜¯ä¸€ä¸ª**æ”¯æŒæ‰¹é‡ç”Ÿæˆ947é¬¼å›¾çš„**çš„å¼€æºé¡¹ç›®ï¼Œç»“åˆäº† YOLOv11 æ£€æµ‹ä¸ OpenCV Inpainting æŠ€æœ¯ï¼Œå…·å¤‡å›¾å½¢ç•Œé¢å’Œ HTTP API åŒé‡å½¢æ€ã€‚ä½ å¯ä»¥é€šè¿‡ Web ä¸Šä¼ å›¾ç‰‡ / GIF è½»æ¾ç”Ÿæˆ947é¬¼å›¾ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºæœåŠ¡é›†æˆåˆ°ä½ çš„ç³»ç»Ÿä¸­ã€‚

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. å…‹éš†ä»“åº“å¹¶è¿›å…¥ç›®å½•
   git clone https://github.com/ryujou/auto-947.git
   cd face-swap-api

### 2. åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
   python3 -m venv venv
   source venv/bin/activate

### 3. å®‰è£…ä¾èµ–
   pip install -r requirements.txt

### 4. å‡†å¤‡æ¨¡å‹ä¸èµ„æº
   - å°† best.ptï¼ˆYOLOv11 åŠ¨æ¼«äººè„¸æ£€æµ‹æ¨¡å‹ï¼‰æ”¾å…¥ static/best.pt
   - ç¡®ä¿ä»¥ä¸‹æ›¿æ¢å›¾åƒåœ¨ static/ ç›®å½•ä¸­ï¼š
     static/947left.png
     static/947right.png
     static/947mouth.png

------------------------------------------------------------

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
face-swap-api/
â”œâ”€â”€ .gitignore
â”œâ”€â”€ README.md
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ app.py                # Gradio Web ç•Œé¢
â”œâ”€â”€ server.py             # FastAPI HTTP API
â”œâ”€â”€ test_api.py           # æœ¬åœ°æµ‹è¯• API è„šæœ¬
â”œâ”€â”€ static/
â”‚   â”œâ”€â”€ best.pt
â”‚   â”œâ”€â”€ 947left.png
â”‚   â”œâ”€â”€ 947right.png
â”‚   â””â”€â”€ 947mouth.png
â””â”€â”€ face_swap/
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ config.py         # è·¯å¾„ä¸å‚æ•°é…ç½®
    â”œâ”€â”€ model.py          # YOLO åŠ è½½
    â”œâ”€â”€ utils.py          # inpaint ä¸ overlay å‡½æ•°
    â””â”€â”€ core.py           # ä¸»å¤„ç†æµç¨‹ API
```
------------------------------------------------------------

## ğŸ§  æ ¸å¿ƒæµç¨‹è¯´æ˜ï¼ˆè§ core.pyï¼‰ï¼š

1. åŠ è½½ YOLOv11 æ¨¡å‹
2. ä½¿ç”¨æ¨¡å‹æ£€æµ‹ face / eyes / mouth
3. æ ¹æ®äººè„¸ä¸­å¿ƒåˆ¤æ–­å·¦å³çœ¼ bbox
4. ä½¿ç”¨ OpenCV inpaint å»é™¤çœ¼ç›ä¸å˜´å·´åŒºåŸŸ
5. å°†æ›¿æ¢å›¾åƒï¼ˆå¸¦ alpha é€šé“ï¼‰è´´åˆ°å¯¹åº”ä½ç½®
6. è¿”å›å¤„ç†åçš„å›¾åƒ

------------------------------------------------------------

## ğŸš€è¿è¡Œæ–¹å¼ï¼š

### æ–¹å¼ä¸€ï¼šå¯åŠ¨ Gradio Web ç•Œé¢
   ```bash
   python app.py
   ```
   æµè§ˆå™¨è®¿é—® http://127.0.0.1:7860

### æ–¹å¼äºŒï¼šå¯åŠ¨ FastAPI HTTP API æœåŠ¡
   ```bash
   python server.py
   ```
   - POST /swap     ä¸Šä¼ å›¾ç‰‡å¹¶è¿”å›å¤„ç†åç»“æœï¼Œå‚æ•°ï¼šfile=å›¾ç‰‡æ–‡ä»¶, conf=ç½®ä¿¡åº¦
   - GET  /health   æ£€æŸ¥æœåŠ¡çŠ¶æ€

### æµ‹è¯•æ¥å£ï¼š

 - å‡†å¤‡ä¸€å¼  input/test.jpg
 - è¿è¡Œï¼š
   ```bash
   python test_api.py
   ```
 - é»˜è®¤è¾“å‡ºä¸º output/test_result.jpg

------------------------------------------------------------

## ğŸ“¦ ä¾èµ–åˆ—è¡¨ï¼ˆrequirements.txtï¼‰ï¼š

- ultralytics>=8.0.0
- opencv-python
- numpy
- gradio
- fastapi
- uvicorn[standard]
- Pillow
- requests

------------------------------------------------------------

## ğŸ“Œ TODO

- [ ] æ¥å…¥QQæœºå™¨äººå®ç°åœ¨ç¾¤èŠä¸­è‡ªåŠ¨ç”Ÿæˆé¬¼å›¾
- [ ] æ”¯æŒè§†é¢‘è¾“å…¥ï¼ˆé€å¸§å¤„ç† + æ‹¼æ¥ï¼‰


------------------------------------------------------------

LICENSE

MIT License Â© 2024 ryujou
